# ğŸ‰ åŠŸèƒ½å®ç°å®Œæˆï¼æ¥ä¸‹æ¥çš„æ­¥éª¤

## âœ… å·²å®Œæˆçš„å·¥ä½œ

æ‰€æœ‰ä»£ç å·²å®ç°å¹¶æ„å»ºæˆåŠŸï¼ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š

### 1. è®¤è¯ç³»ç»Ÿ
- âœ… é‚®ç®±å¯†ç æ³¨å†Œ/ç™»å½•
- âœ… ç”¨æˆ·ä¼šè¯ç®¡ç†
- âœ… ç™»å½•çŠ¶æ€ä¿æŠ¤
- âœ… ç”¨æˆ·èœå•ï¼ˆæ˜¾ç¤ºé‚®ç®±ã€é€€å‡ºç™»å½•ï¼‰

### 2. å¤šç”»å¸ƒç®¡ç†
- âœ… ç”»å¸ƒåˆ‡æ¢å™¨ï¼ˆé¡¶éƒ¨ä¸‹æ‹‰èœå•ï¼‰
- âœ… åˆ›å»ºæ–°ç”»å¸ƒ
- âœ… åˆ é™¤ç”»å¸ƒ
- âœ… ç”»å¸ƒåˆ—è¡¨å±•ç¤º

### 3. æ•°æ®åŒæ­¥
- âœ… æœ¬åœ° IndexedDB å­˜å‚¨
- âœ… äº‘ç«¯ Supabase å­˜å‚¨
- âœ… å®šæ—¶åŒæ­¥ï¼ˆ30ç§’ï¼‰
- âœ… ç”»å¸ƒåˆ‡æ¢æ—¶åŒæ­¥
- âœ… ç¦»çº¿é˜Ÿåˆ—æ”¯æŒ
- âœ… åŒæ­¥çŠ¶æ€æŒ‡ç¤ºå™¨

### 4. UI é›†æˆ
- âœ… é¡¶éƒ¨å·¥å…·æ ï¼ˆç”»å¸ƒåˆ‡æ¢å™¨ + åŒæ­¥çŠ¶æ€ + ç”¨æˆ·èœå•ï¼‰
- âœ… Toast é€šçŸ¥
- âœ… åŠ è½½çŠ¶æ€

---

## ğŸš€ ä¸‹ä¸€æ­¥ï¼šé…ç½®å’Œæµ‹è¯•

### Step 1: é…ç½® Supabaseï¼ˆ15åˆ†é’Ÿï¼‰

#### 1.1 åˆ›å»º Supabase é¡¹ç›®
1. è®¿é—® https://supabase.com/dashboard
2. ç‚¹å‡» "New Project"
3. å¡«å†™ä¿¡æ¯ï¼š
   - Name: `infinite-canvas-ai`
   - Database Password: **è®¾ç½®ä¸€ä¸ªå¼ºå¯†ç å¹¶ä¿å­˜**
   - Region: é€‰ Singapore æˆ– Tokyoï¼ˆç¦»ä¸­å›½è¿‘ï¼‰
4. ç­‰å¾…é¡¹ç›®åˆ›å»ºå®Œæˆï¼ˆçº¦2åˆ†é’Ÿï¼‰

#### 1.2 æ‰§è¡Œ SQL è„šæœ¬
1. åœ¨å·¦ä¾§èœå•é€‰æ‹© **SQL Editor**
2. ç‚¹å‡» "+ New Query"
3. å¤åˆ¶ `supabase-schema.sql` çš„**å…¨éƒ¨å†…å®¹**
4. ç²˜è´´åˆ°ç¼–è¾‘å™¨
5. ç‚¹å‡» **Run** æŒ‰é’®ï¼ˆæˆ–æŒ‰ Cmd/Ctrl+Enterï¼‰
6. ç¡®è®¤æ˜¾ç¤º "Success. No rows returned"

#### 1.3 è·å– API å¯†é’¥
1. è¿›å…¥ **Project Settingsï¼ˆå·¦ä¸‹è§’é½¿è½®å›¾æ ‡ï¼‰> API**
2. æ‰¾åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š
   - **Project URL**: `https://xxxxx.supabase.co`
   - **anon public** key: `eyJh...` ï¼ˆå¾ˆé•¿çš„ä¸€ä¸²ï¼‰
3. å¤åˆ¶è¿™ä¸¤ä¸ªå€¼

#### 1.4 æ›´æ–°ç¯å¢ƒå˜é‡
ç¼–è¾‘ `.env.local` æ–‡ä»¶ï¼š

```env
# ä¿ç•™ç°æœ‰çš„ API Key
ANTHROPIC_API_KEY=ä½ çš„ç°æœ‰å¯†é’¥

# æ·»åŠ  Supabase é…ç½®
NEXT_PUBLIC_SUPABASE_URL=https://ä½ çš„é¡¹ç›®id.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhå¼€å¤´çš„é•¿å­—ç¬¦ä¸²
```

âš ï¸ **é‡è¦**ï¼šä¿å­˜åé‡å¯å¼€å‘æœåŠ¡å™¨ï¼

---

### Step 2: å¯åŠ¨å¹¶æµ‹è¯•ï¼ˆ10åˆ†é’Ÿï¼‰

#### 2.1 å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
npm run dev
```

è®¿é—® http://localhost:3000

#### 2.2 æµ‹è¯•æ³¨å†ŒåŠŸèƒ½
1. åº”è¯¥ä¼šè‡ªåŠ¨è·³è½¬åˆ° `/login`
2. ç‚¹å‡» "ç«‹å³æ³¨å†Œ" é“¾æ¥
3. å¡«å†™é‚®ç®±å’Œå¯†ç ï¼ˆå¯†ç è‡³å°‘6ä½ï¼‰
4. ç‚¹å‡» "æ³¨å†Œ"
5. æ£€æŸ¥é‚®ç®±ï¼Œç‚¹å‡»éªŒè¯é“¾æ¥

> **æ³¨æ„**ï¼šSupabase çš„éªŒè¯é‚®ä»¶å¯èƒ½åœ¨åƒåœ¾ç®±ï¼Œå¦‚æœæ²¡æ”¶åˆ°å¯ä»¥ï¼š
> - åœ¨ Supabase Dashboard > Authentication > Users ä¸­æ‰¾åˆ°ä½ çš„ç”¨æˆ·ï¼Œç‚¹å‡» "..." > "Send Magic Link"
> - æˆ–è€…åœ¨ Authentication > Email Templates ä¸­ç¦ç”¨é‚®ç®±éªŒè¯ï¼ˆä»…ç”¨äºæµ‹è¯•ï¼‰

#### 2.3 æµ‹è¯•ç™»å½•å’Œç”»å¸ƒ
1. éªŒè¯é‚®ç®±åï¼Œå›åˆ°ç™»å½•é¡µé¢ç™»å½•
2. ç™»å½•æˆåŠŸååº”è¯¥çœ‹åˆ°ï¼š
   - é¡¶éƒ¨å·¥å…·æ 
   - ç”»å¸ƒåˆ‡æ¢å™¨æ˜¾ç¤º "æˆ‘çš„æ€ç»´ç”»å¸ƒ"
   - åŒæ­¥çŠ¶æ€æ˜¾ç¤º "å·²åŒæ­¥"
   - ç”¨æˆ·èœå•æ˜¾ç¤ºä½ çš„é‚®ç®±

#### 2.4 æµ‹è¯•å¤šç”»å¸ƒåŠŸèƒ½
1. ç‚¹å‡»ç”»å¸ƒåˆ‡æ¢å™¨ä¸‹æ‹‰èœå•
2. ç‚¹å‡» "æ–°å»ºç”»å¸ƒ" æŒ‰é’®
3. è¾“å…¥åç§°ï¼Œæ¯”å¦‚ "æµ‹è¯•ç”»å¸ƒ2"
4. ç¡®è®¤ç”»å¸ƒå·²åˆ›å»ºå¹¶åˆ‡æ¢
5. åœ¨æ–°ç”»å¸ƒä¸­æ·»åŠ å‡ ä¸ªèŠ‚ç‚¹
6. å†æ¬¡ç‚¹å‡»ç”»å¸ƒåˆ‡æ¢å™¨
7. åˆ‡æ¢å› "æˆ‘çš„æ€ç»´ç”»å¸ƒ"
8. ç¡®è®¤ä¹‹å‰çš„å†…å®¹è¿˜åœ¨

#### 2.5 æµ‹è¯•æ•°æ®åŒæ­¥
1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. åˆ‡æ¢åˆ° **Network** æ ‡ç­¾
3. ç­›é€‰å™¨é€‰æ‹© **Fetch/XHR**
4. åœ¨ç”»å¸ƒä¸­æ·»åŠ ä¸€äº›èŠ‚ç‚¹
5. ç­‰å¾…çº¦30ç§’
6. è§‚å¯Ÿ Network é¢æ¿ï¼Œåº”è¯¥çœ‹åˆ°è¯·æ±‚å‘é€åˆ° `supabase.co`
7. è¿›å…¥ Supabase Dashboard > **Table Editor** > **nodes**
8. ç¡®è®¤èƒ½çœ‹åˆ°ä½ åˆšåˆ›å»ºçš„èŠ‚ç‚¹æ•°æ®

#### 2.6 æµ‹è¯•å¤šè®¾å¤‡åŒæ­¥
1. åœ¨å¦ä¸€ä¸ªæµè§ˆå™¨ï¼ˆæˆ–æ— ç—•æ¨¡å¼ï¼‰æ‰“å¼€ http://localhost:3000
2. ç”¨åŒä¸€è´¦å·ç™»å½•
3. ç¡®è®¤èƒ½çœ‹åˆ°ç›¸åŒçš„ç”»å¸ƒåˆ—è¡¨
4. åœ¨è®¾å¤‡Aæ·»åŠ èŠ‚ç‚¹ï¼Œç­‰å¾…30ç§’
5. åœ¨è®¾å¤‡Båˆ·æ–°é¡µé¢
6. ç¡®è®¤èƒ½çœ‹åˆ°æ–°æ·»åŠ çš„èŠ‚ç‚¹

---

### Step 3: éªŒè¯æ•°æ®åº“ï¼ˆ5åˆ†é’Ÿï¼‰

åœ¨ Supabase Dashboard ä¸­æ£€æŸ¥ï¼š

#### 3.1 Canvases è¡¨
**è·¯å¾„**ï¼šTable Editor > canvases

åº”è¯¥çœ‹åˆ°ï¼š
- ä½ åˆ›å»ºçš„æ‰€æœ‰ç”»å¸ƒ
- æ¯ä¸ªç”»å¸ƒæœ‰ `id`, `user_id`, `name`, `created_at`, `updated_at`
- `user_id` å¯¹åº”ä½ çš„ç”¨æˆ·ID

#### 3.2 Nodes è¡¨
**è·¯å¾„**ï¼šTable Editor > nodes

åº”è¯¥çœ‹åˆ°ï¼š
- æ‰€æœ‰åˆ›å»ºçš„èŠ‚ç‚¹
- åŒ…å« `content`, `position`, `size` ç­‰å­—æ®µ
- `canvas_id` å…³è”åˆ°ç”»å¸ƒ
- `user_id` å…³è”åˆ°ç”¨æˆ·

#### 3.3 Chat Sessions è¡¨
**è·¯å¾„**ï¼šTable Editor > chat_sessions

åº”è¯¥çœ‹åˆ°ï¼š
- èŠå¤©ä¼šè¯è®°å½•
- `messages` å­—æ®µåŒ…å« JSON æ ¼å¼çš„æ¶ˆæ¯å†å²

#### 3.4 Authentication
**è·¯å¾„**ï¼šAuthentication > Users

åº”è¯¥çœ‹åˆ°ï¼š
- ä½ çš„æ³¨å†Œç”¨æˆ·
- é‚®ç®±éªŒè¯çŠ¶æ€
- æ³¨å†Œæ—¶é—´

---

## ğŸ¯ åŠŸèƒ½æ¸…å•

### âœ… å·²å®ç°
- [x] ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
- [x] å¤šç”»å¸ƒç®¡ç†
- [x] ç”»å¸ƒåˆ‡æ¢
- [x] æ•°æ®äº‘ç«¯å­˜å‚¨
- [x] å®šæ—¶è‡ªåŠ¨åŒæ­¥ï¼ˆ30ç§’ï¼‰
- [x] ç”»å¸ƒåˆ‡æ¢æ—¶åŒæ­¥
- [x] ç¦»çº¿é˜Ÿåˆ—
- [x] åŒæ­¥çŠ¶æ€æ˜¾ç¤º
- [x] Toast é€šçŸ¥
- [x] ç”¨æˆ·èœå•

### ğŸ“‹ åç»­å¯ä»¥æ·»åŠ çš„åŠŸèƒ½
- [ ] ç”»å¸ƒé‡å‘½åï¼ˆç›®å‰åªèƒ½åˆ›å»ºæ—¶å‘½åï¼‰
- [ ] ç”»å¸ƒæœç´¢/è¿‡æ»¤
- [ ] å®æ—¶å¤šè®¾å¤‡åä½œï¼ˆä½¿ç”¨ Supabase Realtimeï¼‰
- [ ] æ•°æ®å¯¼å‡ºåŠŸèƒ½
- [ ] ç”»å¸ƒæ¨¡æ¿
- [ ] åˆ†äº«é“¾æ¥
- [ ] åä½œé‚€è¯·

---

## ğŸ› å¸¸è§é—®é¢˜

### Q: æ³¨å†Œåæ”¶ä¸åˆ°éªŒè¯é‚®ä»¶
**A:**
1. æ£€æŸ¥åƒåœ¾é‚®ä»¶æ–‡ä»¶å¤¹
2. åœ¨ Supabase Dashboard > Authentication > Users ä¸­æ‰‹åŠ¨å‘é€éªŒè¯é“¾æ¥
3. æˆ–æš‚æ—¶ç¦ç”¨é‚®ç®±éªŒè¯ï¼ˆä»…æµ‹è¯•ç”¨ï¼‰ï¼š
   - Settings > Authentication > Email Auth
   - å–æ¶ˆå‹¾é€‰ "Enable email confirmations"

### Q: åŒæ­¥å¤±è´¥
**A:**
1. æ£€æŸ¥ .env.local ä¸­çš„å¯†é’¥æ˜¯å¦æ­£ç¡®
2. æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹é”™è¯¯
3. æ£€æŸ¥ Supabase Dashboard > Logs æŸ¥çœ‹æœåŠ¡ç«¯æ—¥å¿—
4. ç¡®è®¤é‡å¯äº†å¼€å‘æœåŠ¡å™¨

### Q: æ„å»ºé”™è¯¯
**A:**
```bash
# æ¸…ç†å¹¶é‡æ–°æ„å»º
rm -rf .next node_modules
npm install
npm run build
```

### Q: ç±»å‹é”™è¯¯
**A:**
```bash
# æ£€æŸ¥ç±»å‹
npx tsc --noEmit
```

---

## ğŸ“¦ éƒ¨ç½²åˆ° Vercel

### å‡†å¤‡å·¥ä½œ
1. å°†ä»£ç æ¨é€åˆ° GitHub
2. åœ¨ Vercel å¯¼å…¥é¡¹ç›®
3. æ·»åŠ ç¯å¢ƒå˜é‡ï¼ˆåœ¨ Vercel é¡¹ç›®è®¾ç½®ä¸­ï¼‰ï¼š
   - `ANTHROPIC_API_KEY`
   - `NEXT_PUBLIC_SUPABASE_URL`
   - `NEXT_PUBLIC_SUPABASE_ANON_KEY`

### Supabase é…ç½®
åœ¨ Supabase Dashboard > Authentication > URL Configuration ä¸­æ·»åŠ ï¼š
- Site URL: `https://ä½ çš„åŸŸå.vercel.app`
- Redirect URLs:
  - `https://ä½ çš„åŸŸå.vercel.app/auth/callback`
  - `http://localhost:3000/auth/callback` ï¼ˆä¿ç•™ç”¨äºæœ¬åœ°å¼€å‘ï¼‰

### éƒ¨ç½²
ç‚¹å‡» "Deploy" å³å¯ï¼

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **å®ç°æŒ‡å—**ï¼š`IMPLEMENTATION_GUIDE.md`
- **SQL è„šæœ¬**ï¼š`supabase-schema.sql`
- **é¡¹ç›®æ–‡æ¡£**ï¼š`CLAUDE.md`
- **Supabase æ–‡æ¡£**ï¼šhttps://supabase.com/docs
- **Next.js æ–‡æ¡£**ï¼šhttps://nextjs.org/docs

---

## ğŸ‰ å®Œæˆï¼

ç°åœ¨ä½ çš„åº”ç”¨å·²ç»å…·å¤‡äº†å®Œæ•´çš„å¤šç”»å¸ƒå’Œäº‘ç«¯åŒæ­¥åŠŸèƒ½ï¼

éœ€è¦å¸®åŠ©ï¼ŸæŸ¥çœ‹ï¼š
- æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰
- Supabase Dashboard Logs
- `IMPLEMENTATION_GUIDE.md` ä¸­çš„æ•…éšœæ’é™¤éƒ¨åˆ†

ç¥ä½¿ç”¨æ„‰å¿«ï¼ğŸš€
